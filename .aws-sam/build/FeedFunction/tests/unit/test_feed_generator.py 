# test_feed_generator.py

import pytest
from multilingue.core.filtro_multilingue import FiltroMultilingue
from multilingue.core.feed_generator import FeedGenerator

@ pytest.fixture
def filtro():
    return FiltroMultilingue()

@ pytest.fixture
def generator(filtro):
    return FeedGenerator(filtro)


def test_prioridad_es(generator):
    textos = [
        "Texto en español",  # prioritario
        "Text in English",   # no soportado
        "Texto en galego",   # gallego
    ]
    feed = generator.generar_feed(textos)
    # El primer ítem debe ser español
    assert feed[0]['idioma'] == 'español'
    assert feed[0]['prioridad'] is True


def test_no_prioritarios(generator):
    textos = [
        "Texto en catalán",
        "Hau euskaraz"
    ]
    feed = generator.generar_feed(textos)
    # Ninguno es español, prioridad False
    assert all(not item['prioridad'] for item in feed)
